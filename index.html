<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5">
  <title>Problem tracker · LeetCode · HackerRank · Codeforces</title>
  <!-- Font Awesome 6 (free) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- Google Fonts (Inter) optional, clean look -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,400;14..32,500;14..32,600;14..32,700&display=swap" rel="stylesheet">
  <style>
    /* reset & base */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    body {
      background: #f7f9fc;
      color: #1e293b;
      line-height: 1.5;
      padding: 1.5rem;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    /* header */
    h1 {
      font-weight: 700;
      font-size: 2rem;
      letter-spacing: -0.01em;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      color: #0f172a;
      margin-bottom: 0.25rem;
    }

    .subhead {
      color: #475569;
      margin-bottom: 2rem;
      border-left: 4px solid #3b82f6;
      padding-left: 1rem;
      font-weight: 400;
    }

    /* form card */
    .form-card {
      background: white;
      border-radius: 20px;
      padding: 1.8rem 2rem;
      box-shadow: 0 8px 20px rgba(0,0,0,0.02), 0 2px 6px rgba(0,0,0,0.05);
      margin-bottom: 2.5rem;
      border: 1px solid #e9eef2;
    }

    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 1.2rem;
      align-items: flex-end;
    }

    .form-group {
      flex: 1 1 180px;
      min-width: 160px;
    }

    label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 600;
      color: #4b5563;
      display: block;
      margin-bottom: 0.3rem;
    }

    input, select, button {
      border-radius: 12px;
      border: 1px solid #e2e8f0;
      padding: 0.7rem 1rem;
      font-size: 0.95rem;
      background: white;
      transition: all 0.15s;
      width: 100%;
    }

    input:focus, select:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
    }

    /* file upload styling */
    .file-upload {
      background: #f8fafc;
      border: 1px dashed #94a3b8;
      padding: 0.5rem;
      border-radius: 12px;
      position: relative;
    }

    .file-upload:hover {
      background: #f1f5f9;
    }

    #image-preview {
      margin-top: 0.8rem;
      max-width: 120px;
      border-radius: 12px;
      overflow: hidden;
      display: none;
      border: 1px solid #e2e8f0;
    }

    #image-preview img {
      width: 100%;
      height: auto;
      display: block;
    }

    .btn-primary {
      background: #2563eb;
      color: white;
      border: none;
      font-weight: 600;
      padding: 0.8rem 1.8rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      transition: background 0.2s;
      width: auto;
      margin-top: 0.5rem;
    }

    .btn-primary:hover {
      background: #1d4ed8;
    }

    .btn-danger {
      background: white;
      color: #b91c1c;
      border: 1px solid #fecaca;
    }

    .btn-danger:hover {
      background: #fee2e2;
    }

    /* filter bar */
    .filter-bar {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 0.8rem;
      margin-bottom: 2rem;
      background: white;
      padding: 0.8rem 1.5rem;
      border-radius: 40px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.02);
    }

    .filter-btn {
      background: transparent;
      border: none;
      padding: 0.5rem 1.4rem;
      border-radius: 40px;
      font-weight: 500;
      color: #475569;
      cursor: pointer;
      transition: all 0.15s;
      width: auto;
      border: 1px solid transparent;
    }

    .filter-btn.active {
      background: #2563eb;
      color: white;
    }

    .filter-btn:hover:not(.active) {
      background: #f1f5f9;
      border-color: #cbd5e1;
    }

    /* grid */
    .problems-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.8rem;
      margin-top: 0.5rem;
    }

    /* card */
    .card {
      background: white;
      border-radius: 24px;
      padding: 1.4rem 1.5rem 1.5rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.03);
      transition: all 0.2s;
      border: 1px solid #edf2f7;
      display: flex;
      flex-direction: column;
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 25px -5px rgba(0,0,0,0.05), 0 8px 10px -6px rgba(0,0,0,0.02);
      border-color: #d1d9e6;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.8rem;
    }

    .platform {
      font-weight: 600;
      font-size: 0.9rem;
      background: #f1f4f9;
      padding: 0.3rem 1rem;
      border-radius: 30px;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      color: #1e293b;
    }

    .difficulty-badge {
      font-size: 0.75rem;
      font-weight: 700;
      padding: 0.25rem 0.85rem;
      border-radius: 30px;
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }

    .Easy { background: #dcfce7; color: #166534; }
    .Medium { background: #fef9c3; color: #854d0e; }
    .Hard { background: #fee2e2; color: #991b1b; }

    .problem-title {
      font-weight: 700;
      font-size: 1.2rem;
      margin: 0.2rem 0 0.1rem;
      color: #0f172a;
    }

    .problem-id {
      color: #4b5563;
      font-size: 0.85rem;
      margin-bottom: 0.8rem;
      background: #f8fafc;
      padding: 0.2rem 0.8rem;
      border-radius: 20px;
      display: inline-block;
    }

    .notebook-img {
      margin: 0.9rem 0;
      border-radius: 16px;
      overflow: hidden;
      max-height: 160px;
      display: flex;
      justify-content: center;
      background: #f1f5f9;
    }

    .notebook-img img {
      width: 100%;
      height: auto;
      object-fit: cover;
      border-radius: 12px;
      border: 1px solid #e9eef2;
    }

    .youtube-link {
      margin: 0.5rem 0 0.8rem;
    }

    .youtube-link a {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      background: #fef2f2;
      color: #b91c1c;
      padding: 0.4rem 1rem;
      border-radius: 40px;
      text-decoration: none;
      font-size: 0.85rem;
      font-weight: 500;
      border: 1px solid #fee2e2;
    }

    .youtube-link a:hover {
      background: #fee2e2;
    }

    .revised-area {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 0.6rem;
      border-top: 1px solid #ecf1f6;
      padding-top: 1rem;
    }

    .btn-revised {
      background: transparent;
      border: 1px solid #cbd5e1;
      padding: 0.35rem 1rem;
      border-radius: 40px;
      font-size: 0.8rem;
      font-weight: 600;
      color: #334155;
      display: flex;
      align-items: center;
      gap: 0.4rem;
      width: auto;
    }

    .btn-revised i {
      color: #64748b;
    }

    .btn-revised.revised {
      background: #22c55e;
      border-color: #22c55e;
      color: white;
    }

    .btn-revised.revised i {
      color: white;
    }

    .card-actions {
      display: flex;
      justify-content: flex-end;
      margin-top: 0.8rem;
    }

    .btn-delete {
      background: transparent;
      border: none;
      color: #94a3b8;
      padding: 0.2rem 0.8rem;
      font-size: 0.8rem;
      width: auto;
    }

    .btn-delete:hover {
      color: #b91c1c;
      background: #fef2f2;
    }

    .empty-message {
      grid-column: 1 / -1;
      text-align: center;
      padding: 3rem;
      background: white;
      border-radius: 30px;
      color: #64748b;
    }

    .footer-actions {
      display: flex;
      justify-content: flex-end;
      margin-top: 1.5rem;
    }

    .btn-outline {
      background: transparent;
      border: 1px solid #cbd5e1;
      color: #475569;
      width: auto;
    }

    /* responsive */
    @media (max-width: 640px) {
      body { padding: 1rem; }
      .form-card { padding: 1.5rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>
      <i class="fas fa-code-branch" style="color: #2563eb;"></i> DSA arsenal
    </h1>
    <div class="subhead">
      <i class="fas fa-notebook"></i> track Leetcode, HackerRank, Codeforces — with notebook photos & YouTube revisions
    </div>

    <!-- ADD NEW PROBLEM CARD -->
    <div class="form-card">
      <form id="problem-form">
        <div style="display: flex; flex-wrap: wrap; gap: 1.5rem; align-items: flex-start;">
          <div style="flex: 2; min-width: 260px;">
            <div class="form-row">
              <div class="form-group">
                <label><i class="fas fa-globe"></i> Platform</label>
                <select id="platform" required>
                  <option value="LeetCode">LeetCode</option>
                  <option value="HackerRank">HackerRank</option>
                  <option value="Codeforces">Codeforces</option>
                </select>
              </div>
              <div class="form-group">
                <label><i class="fas fa-hashtag"></i> Problem ID</label>
                <input type="text" id="problem-id" placeholder="e.g. 1, 2Sum, 123A" required>
              </div>
              <div class="form-group">
                <label><i class="fas fa-tag"></i> Title (optional)</label>
                <input type="text" id="problem-title" placeholder="Two Sum / XOR ...">
              </div>
              <div class="form-group">
                <label><i class="fas fa-layer-group"></i> Difficulty</label>
                <select id="difficulty" required>
                  <option value="Easy">Easy</option>
                  <option value="Medium">Medium</option>
                  <option value="Hard">Hard</option>
                </select>
              </div>
            </div>
            <div style="display: flex; flex-wrap: wrap; gap: 1.5rem; margin-top: 0.8rem;">
              <div style="flex: 1 1 200px;">
                <label><i class="fas fa-image"></i> Notebook photo (dry run)</label>
                <div class="file-upload">
                  <input type="file" id="image-upload" accept="image/*">
                </div>
                <div id="image-preview"></div>
              </div>
              <div style="flex: 1 1 240px;">
                <label><i class="fab fa-youtube"></i> YouTube solution link</label>
                <input type="url" id="youtube-link" placeholder="https://youtu.be/...">
              </div>
              <div style="display: flex; align-items: center; gap: 1.5rem; flex-wrap: wrap;">
                <div style="display: flex; align-items: center; gap: 0.4rem;">
                  <input type="checkbox" id="revised-checkbox" style="width: 18px; height: 18px; accent-color: #2563eb;">
                  <label style="display: inline; text-transform: none; font-weight: 500; margin: 0;">Revised already?</label>
                </div>
                <button type="submit" class="btn-primary"><i class="fas fa-plus-circle"></i> Add problem</button>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>

    <!-- FILTER BUTTONS (EASY / MEDIUM / HARD) -->
    <div class="filter-bar">
      <span style="color: #475569; font-weight: 500;"><i class="fas fa-filter"></i> Filter:</span>
      <button class="filter-btn active" data-filter="all">All</button>
      <button class="filter-btn" data-filter="Easy">Easy</button>
      <button class="filter-btn" data-filter="Medium">Medium</button>
      <button class="filter-btn" data-filter="Hard">Hard</button>
      <div style="flex:1"></div>
      <button id="resetAllBtn" class="btn-outline" style="width: auto;"><i class="fas fa-eraser"></i> Reset data</button>
    </div>

    <!-- PROBLEMS GRID (cards injected) -->
    <section id="problems-grid" class="problems-grid">
      <!-- dynamic content from js -->
    </section>
    
    <div class="footer-actions">
      <span style="color: #64748b; font-size: 0.85rem;"><i class="fas fa-save"></i> auto-saved in browser (localStorage)</span>
    </div>
  </div>

  <script>
    (function() {
      "use strict";

      // ----- STORAGE KEY -----
      const STORAGE_KEY = 'trackerEntries';

      // ----- SAMPLE / INITIAL DATA (only if empty) -----
      const sampleEntries = [
        {
          id: 'sample1',
          platform: 'LeetCode',
          problemId: '1',
          problemTitle: 'Two Sum',
          difficulty: 'Easy',
          imageData: null,
          youtubeLink: 'https://youtu.be/KLlXCFG5TnA',
          revised: true,
          dateAdded: new Date().toISOString()
        },
        {
          id: 'sample2',
          platform: 'Codeforces',
          problemId: '4A',
          problemTitle: 'Watermelon',
          difficulty: 'Easy',
          imageData: null,
          youtubeLink: 'https://youtu.be/0y2i7nJqH5A',
          revised: false,
          dateAdded: new Date().toISOString()
        },
        {
          id: 'sample3',
          platform: 'HackerRank',
          problemId: 'Arrays: Left Rotation',
          problemTitle: 'Left Rotation',
          difficulty: 'Medium',
          imageData: null,
          youtubeLink: '',
          revised: true,
          dateAdded: new Date().toISOString()
        }
      ];

      // ----- current filter (default 'all') -----
      let currentFilter = 'all';

      // ----- helper: load entries from localStorage -----
      function loadEntries() {
        const stored = localStorage.getItem(STORAGE_KEY);
        if (stored) {
          try {
            return JSON.parse(stored);
          } catch (e) {
            return [];
          }
        } else {
          // seed with sample data
          localStorage.setItem(STORAGE_KEY, JSON.stringify(sampleEntries));
          return sampleEntries;
        }
      }

      // ----- save entries -----
      function saveEntries(entries) {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(entries));
      }

      // ----- RESIZE image (reduces quality & size, max width 300) -----
      function resizeImage(file, maxWidth = 300) {
        return new Promise((resolve) => {
          if (!file) {
            resolve(null);
            return;
          }
          const reader = new FileReader();
          reader.onload = (e) => {
            const img = new Image();
            img.onload = () => {
              const canvas = document.createElement('canvas');
              let width = img.width;
              let height = img.height;
              if (width > maxWidth) {
                height = Math.floor((maxWidth / width) * height);
                width = maxWidth;
              }
              canvas.width = width;
              canvas.height = height;
              const ctx = canvas.getContext('2d');
              ctx.drawImage(img, 0, 0, width, height);
              // get as JPEG with reduced quality
              const dataUrl = canvas.toDataURL('image/jpeg', 0.7);
              resolve(dataUrl);
            };
            img.src = e.target.result;
          };
          reader.readAsDataURL(file);
        });
      }

      // ----- render preview on file select -----
      const fileInput = document.getElementById('image-upload');
      const previewDiv = document.getElementById('image-preview');
      fileInput.addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
          resizeImage(file, 150).then((dataUrl) => {
            previewDiv.style.display = 'block';
            previewDiv.innerHTML = `<img src="${dataUrl}" alt="preview" style="border-radius: 10px;">`;
          });
        } else {
          previewDiv.style.display = 'none';
          previewDiv.innerHTML = '';
        }
      });

      // ----- render cards based on filter -----
      function renderEntries() {
        const entries = loadEntries();
        const grid = document.getElementById('problems-grid');
        
        // filter by difficulty
        let filtered = entries;
        if (currentFilter !== 'all') {
          filtered = entries.filter(entry => entry.difficulty === currentFilter);
        }

        if (filtered.length === 0) {
          grid.innerHTML = `<div class="empty-message">
            <i class="fas fa-smile-wink" style="font-size: 2.2rem; color: #94a3b8; margin-bottom: 1rem;"></i>
            <h3 style="font-weight: 500;">No problems found</h3>
            <p style="color: #64748b;">Add your first problem or change filter.</p>
          </div>`;
          return;
        }

        // build cards HTML
        let html = '';
        filtered.forEach(entry => {
          const revisedClass = entry.revised ? 'revised' : '';
          const revisedIcon = entry.revised ? 'fa-circle-check' : 'fa-circle';
          const revisedText = entry.revised ? 'Revised' : 'Mark revised';
          
          // image display
          const imageHtml = entry.imageData 
            ? `<div class="notebook-img"><img src="${entry.imageData}" alt="notebook sketch" loading="lazy"></div>` 
            : `<div class="notebook-img" style="background: #f1f5f9; padding: 0.8rem; color: #64748b; font-size: 0.8rem; display: flex; align-items: center; justify-content: center; gap: 0.3rem;"><i class="fas fa-camera"></i> no photo</div>`;
          
          // youtube link
          const youtubeHtml = entry.youtubeLink 
            ? `<div class="youtube-link"><a href="${entry.youtubeLink}" target="_blank"><i class="fab fa-youtube"></i> watch solution</a></div>` 
            : '';

          const platformIcon = {
            'LeetCode': '<i class="fas fa-code"></i>',
            'HackerRank': '<i class="fab fa-hackerrank"></i>',
            'Codeforces': '<i class="fas fa-robot"></i>'
          }[entry.platform] || '<i class="fas fa-terminal"></i>';

          const titleDisplay = entry.problemTitle ? entry.problemTitle : entry.problemId;

          html += `<div class="card" data-entry-id="${entry.id}">
            <div class="card-header">
              <span class="platform">${platformIcon} ${entry.platform}</span>
              <span class="difficulty-badge ${entry.difficulty}">${entry.difficulty}</span>
            </div>
            <div class="problem-title">${escapeHTML(titleDisplay)}</div>
            <div class="problem-id"><i class="fas fa-hashtag"></i> ${escapeHTML(entry.problemId)}</div>
            ${imageHtml}
            ${youtubeHtml}
            <div class="revised-area">
              <button class="btn-revised ${revisedClass}" data-id="${entry.id}" data-revised-toggle>
                <i class="fas ${revisedIcon}"></i> ${revisedText}
              </button>
              <span style="font-size:0.75rem; color:#64748b;"><i class="far fa-calendar-alt"></i> ${new Date(entry.dateAdded).toLocaleDateString()}</span>
            </div>
            <div class="card-actions">
              <button class="btn-delete" data-id="${entry.id}" data-delete-btn>
                <i class="fas fa-trash-alt"></i> delete
              </button>
            </div>
          </div>`;
        });
        grid.innerHTML = html;
      }

      // simple escape for innerHTML (prevent XSS from user input)
      function escapeHTML(text) {
        if (!text) return '';
        return String(text).replace(/[&<>"]/g, function(c) {
          if(c === '&') return '&amp;';
          if(c === '<') return '&lt;';
          if(c === '>') return '&gt;';
          if(c === '"') return '&quot;';
          return c;
        });
      }

      // ----- add new entry -----
      async function addEntry(entry) {
        const entries = loadEntries();
        entries.unshift(entry); // newest first
        saveEntries(entries);
        renderEntries();
      }

      // ----- delete entry -----
      function deleteEntry(id) {
        let entries = loadEntries();
        entries = entries.filter(entry => entry.id !== id);
        saveEntries(entries);
        renderEntries();
      }

      // ----- toggle revised status -----
      function toggleRevised(id) {
        const entries = loadEntries();
        const entry = entries.find(e => e.id === id);
        if (entry) {
          entry.revised = !entry.revised;
          saveEntries(entries);
          renderEntries();
        }
      }

      // ----- reset ALL data with confirmation-----
      function resetAllData() {
        if (confirm('Delete ALL your problems? This cannot be undone.')) {
          localStorage.setItem(STORAGE_KEY, JSON.stringify(sampleEntries));
          renderEntries();
        }
      }

      // ----- EVENT LISTENERS -----
      document.addEventListener('DOMContentLoaded', function() {
        // initial render
        renderEntries();

        // ----- FORM SUBMIT (add problem) -----
        const form = document.getElementById('problem-form');
        form.addEventListener('submit', async function(e) {
          e.preventDefault();

          const platform = document.getElementById('platform').value;
          const problemId = document.getElementById('problem-id').value.trim();
          const problemTitle = document.getElementById('problem-title').value.trim();
          const difficulty = document.getElementById('difficulty').value;
          const youtubeLink = document.getElementById('youtube-link').value.trim();
          const revised = document.getElementById('revised-checkbox').checked;
          const file = document.getElementById('image-upload').files[0];

          if (!problemId) {
            alert('Problem ID is required');
            return;
          }

          // resize image (if any) to store as base64
          let imageData = null;
          if (file) {
            try {
              imageData = await resizeImage(file, 280);
            } catch (err) {
              console.warn('Image resize failed', err);
            }
          }

          const newEntry = {
            id: Date.now().toString() + '-' + Math.random().toString(36).substring(2, 6),
            platform,
            problemId,
            problemTitle: problemTitle || '',
            difficulty,
            imageData: imageData,
            youtubeLink: youtubeLink || '',
            revised: revised,
            dateAdded: new Date().toISOString()
          };

          await addEntry(newEntry);

          // reset form and preview
          form.reset();
          previewDiv.style.display = 'none';
          previewDiv.innerHTML = '';
          document.getElementById('revised-checkbox').checked = false; // explicit reset
        });

        // ----- FILTER BUTTONS (difficulty) -----
        const filterButtons = document.querySelectorAll('.filter-btn');
        filterButtons.forEach(btn => {
          btn.addEventListener('click', function() {
            filterButtons.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            currentFilter = this.dataset.filter;
            renderEntries();
          });
        });

        // ----- EVENT DELEGATION (delete & toggle revised) -----
        const grid = document.getElementById('problems-grid');
        grid.addEventListener('click', function(e) {
          // delete button
          const deleteBtn = e.target.closest('[data-delete-btn]');
          if (deleteBtn) {
            const id = deleteBtn.dataset.id;
            if (id) deleteEntry(id);
            return;
          }

          // toggle revised button
          const reviseBtn = e.target.closest('[data-revised-toggle]');
          if (reviseBtn) {
            const id = reviseBtn.dataset.id;
            if (id) toggleRevised(id);
            return;
          }
        });

        // ----- RESET ALL BUTTON -----
        const resetBtn = document.getElementById('resetAllBtn');
        if (resetBtn) {
          resetBtn.addEventListener('click', resetAllData);
        }
      });
    })();
  </script>
</body>
</html>